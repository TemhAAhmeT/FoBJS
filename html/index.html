<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>FoBot v0.1</title>
    <!-- https://electronjs.org/docs/tutorial/security#csp-meta-tag -->
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
    <link rel="stylesheet" href="../css/index.css">
</head>

<body>
    <div id="fill" class="console">
    </div>
    <div id="fill">

    </div>
</body>

<script>
    var consoleEx = (function() {
        var following = false,
            pre = document.createElement('pre'),
            code = document.createElement('code');
        var div = document.querySelector('div#fill');
        pre.appendChild(code);
        div.appendChild(pre);

        return {
            clear: clear,
            follow: follow,
            log: print.bind(this, 'debug'),
            info: print.bind(this, 'info'),
            warn: print.bind(this, 'warn'),
            error: print.bind(this, 'error')
        };

        function clear() {
            while (code.hasChildNodes()) {
                code.removeChild(code.lastChild);
            }
        }

        function follow() {
            following = true;
        }

        function print(className, object) {
            var s = (typeof object === 'string') ? object : JSON.stringify(object),
                span = document.createElement('span'),
                text = document.createTextNode(s + '\n');

            span.setAttribute('class', className);
            span.appendChild(text);
            code.appendChild(span);

            if (following) {
                scrollToBottom();
            }
        }

        function scrollToBottom() {
            window.scrollTo(0, document.body.scrollHeight);
        }
    }());
</script>

<script>
    //consoleEx.log("test");
    var ipc = require('electron').ipcRenderer;
    var div = document.querySelector('div#fill');
    ipc.on("fillDiv", (e, arg) => {
        for (var x = 0; x < arg.length; x++) {
            consoleEx.log(arg[x].key)
        }
    });
</script>

</html>